###
# Generated by Chef for <%= node[:fqdn] %>
# Configured as <%= node[:postfix][:mail_type] %>
###

biff = no
append_dot_mydomain = no
#smtpd_tls_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem
#smtpd_tls_key_file=/etc/ssl/private/ssl-cert-snakeoil.key
#smtpd_use_tls=yes
#smtpd_tls_session_cache_database = btree:${queue_directory}/smtpd_scache
#smtp_tls_session_cache_database = btree:${queue_directory}/smtp_scache
smtp_sasl_auth_enable = <%= node[:postfix][:smtp_sasl_auth_enable] %>
<% if node[:postfix][:smtp_sasl_auth_enable] == "yes" -%>
smtp_sasl_password_maps = <%= node[:postfix][:smtp_sasl_password_maps] %>
smtp_sasl_security_options = <%= node[:postfix][:smtp_sasl_security_options] %>
smtp_tls_CAfile = <%= node[:postfix][:smtp_tls_cafile] %>
smtp_use_tls = <%= node[:postfix][:smtp_use_tls] %>
<% end -%>
myhostname = <%= node[:postfix][:myhostname] %>
mydomain = <%= node[:postfix][:mydomain] %>
myorigin = <%= node[:postfix][:myorigin] %>
smtpd_banner = $myhostname ESMTP $mail_name
alias_maps = mysql:/etc/postfix/mysql-aliases.cf
alias_database = mysql:/etc/postfix/mysql-aliases.cf
mydestination = $transport_maps <%= node[:postfix][:myhostname] %>, <%= node[:hostname] %>, localhost.localdomain, localhost
<% if node[:postfix][:mail_type] == "master" -%>
relayhost =
mynetworks = <%= node[:postfix][:mail_relay_networks] %>
inet_interfaces = all
<% else -%>
relayhost = <%= node[:postfix][:relayhost] %>
mynetworks = <%= node[:postfix][:mail_relay_networks] %>
inet_interfaces = loopback-only
<% end -%>
mailbox_size_limit = 0
recipient_delimiter = +

transport_maps = mysql:/etc/postfix/mysql-transport.cf
virtual_transport = $transport_maps
virtual_mailbox_base = /home/vmail
virtual_mailbox_maps = mysql:/etc/postfix/mysql-virtual-maps.cf
virtual_minimum_uid = 1000
virtual_uid_maps = static:1000
virtual_gid_maps = static:1000
virtual_alias_maps = mysql:/etc/postfix/mysql-virtual.cf



#relocated_maps = mysql:/etc/postfix/mysql-relocated.cf
#home_mailbox = .maildir/
#local_destination_concurrency_limit = 2
#default_destination_concurrency_limit = 10
#debug_peer_level = 2
#debugger_command =
#        PATH=/bin:/usr/bin:/usr/local/bin; export PATH; (echo cont;
#        echo where) | gdb $daemon_directory/$process_name $process_id 2>&1
#        >$config_directory/$process_name.$process_id.log & sleep 5
#
#sendmail_path = /usr/sbin/sendmail
#newaliases_path = /usr/bin/newaliases
#mailq_path = /usr/bin/mailq
#setgid_group = postdrop
##html_directory = /usr/share/doc/postfix-2.5.7/html
#manpage_directory = /usr/share/man
#sample_directory = /etc/postfix
##readme_directory = /usr/share/doc/postfix-2.5.7/readme
#
#smtpd_sasl_auth_enable = yes
#smtpd_sasl2_auth_enable = yes
#smtpd_sasl_security_options = noanonymous
#broken_sasl_auth_clients = yes
#smtpd_sasl_authenticated_header = yes
##smtpd_sasl_local_domain =
#
#smtpd_recipient_restrictions =
#        permit_sasl_authenticated,
#        permit_mynetworks,
#        reject_unauth_destination
#
#smtp_use_tls = yes
#smtp_tls_note_starttls_offer = yes
#smtpd_use_tls = yes
#smtpd_tls_auth_only = yes
#smtpd_tls_key_file = /etc/postfix/newkey.pem
#smtpd_tls_cert_file = /etc/postfix/newreq.pem
#smtpd_tls_CAfile = /etc/postfix/cacert.pem
#smtpd_tls_loglevel = 3
#smtpd_tls_received_header = yes
#smtpd_tls_session_cache_timeout = 3600s
#tls_random_source = dev:/dev/urandom

